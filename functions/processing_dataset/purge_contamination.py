import numpy as np
import pandas as pd


# List of contaminants in negative mode without palmitic oleic and stearic acids
conts_neg = [26.00362, 44.9982, 59.01385, 78.95906, 79.95737, 94.98084, 96.96011, 96.96962,
             112.98559, 112.98563, 126.90502, 162.9824, 212.07507, 226.97845, 248.9604,
             316.7391, 318.73729]

# List of contaminants in positive mode
conts_pos = [33.03349, 42.03383, 59.06037, 63.04406, 64.01577, 65.05971, 74.06004, 74.06004,
             77.05971, 79.02121, 83.06037, 85.026, 85.05887, 88.03931, 96.04198, 99.04165,
             100.07569, 100.99994, 101.00316, 101.08084, 102.05496, 102.12773, 103.9556,
             104.99229, 105.04232, 105.95379, 107.07027, 115.01559, 115.08659, 120.04776,
             122.08117, 123.06278, 123.09167, 124.0369, 129.05222, 130.15903, 132.9049,
             133.10705, 135.10157, 137.07431, 142.02971, 144.17468, 144.98215, 145.02615,
             146.06887, 146.98034, 147.1128, 149.02332, 150.12773, 151.09649, 153.13862,
             155.089, 157.03515, 157.08352, 158.96403, 163.03897, 163.13287, 169.09475,
             169.11046, 171.00527, 172.03931, 173.05745, 173.07843, 179.01709, 181.12231,
             183.08044, 183.14383, 185.11482, 186.22163, 189.05237, 190.04987, 193.14344,
             195.06519, 195.1227, 203.10425, 205.12578, 212.03181, 214.08963, 215.12538,
             217.10465, 221.18999, 225.19614, 228.00575, 231.09932, 231.11618, 233.07858,
             236.07157, 239.14892, 239.22485, 241.2219, 242.28423, 243.11683, 243.17194,
             251.1853, 251.20056, 257.03103, 261.13086, 265.21621, 267.17197, 273.12739,
             273.16725, 273.1825, 277.1048, 279.09333, 279.15909, 279.22945, 282.27914,
             283.17513, 284.29479, 287.19815, 288.25332, 289.14118, 293.2451, 295.22677,
             301.14103, 304.26108, 305.15708, 306.27673, 309.22717, 309.24242, 315.25299,
             317.11497, 317.20872, 321.13101, 323.25567, 325.25847, 327.07807, 327.20135,
             331.20911, 331.22437, 337.11841, 337.27132, 338.34174, 339.25299, 347.18305,
             349.18329, 353.26864, 355.06994, 355.36829, 360.32368, 361.23493, 365.15723,
             367.26903, 367.28188, 368.42508, 371.10124, 371.22756, 371.31559, 371.31559,
             375.25058, 379.09246, 381.29753, 383.2792, 388.12779, 389.25098, 391.28429,
             393.20951, 397.29485, 405.22491, 405.26115, 409.18344, 411.3081, 413.26623,
             415.25378, 419.2768, 425.3109, 425.32375, 427.30542, 429.08873, 429.24017,
             437.23572, 441.01479, 441.32107, 443.01298, 445.12003, 447.29284, 449.28736,
             449.385, 453.20966, 453.34353, 454.29278, 455.33431, 459.27999, 462.14658,
             463.26678, 463.30301, 469.34996, 471.33163, 472.28781, 481.26194, 483.35276,
             485.34728, 493.31358, 494.56593, 497.23587, 499.36053, 503.10752, 503.30621,
             505.33471, 507.32923, 513.37618, 515.33001, 515.35785, 515.41286, 519.13882,
             521.30864, 522.59723, 525.28815, 529.3735, 531.40777, 531.47717, 536.16537,
             537.33979, 537.87901, 541.26209, 541.39463, 543.38674, 547.33242, 547.40269,
             550.62853, 551.35544, 553.38972, 553.45912, 555.88957, 557.40239, 559.38406,
             563.37657, 568.13506, 569.31437, 571.35622, 573.39971, 577.12631, 579.35051,
             581.36601, 585.2883, 587.41296, 591.35864, 593.15761, 595.38166, 597.90014,
             599.43649, 601.42861, 603.41028, 606.09149, 610.18416, 613.34058, 615.40375,
             617.42593, 621.41844, 621.97291, 625.39222, 629.31452, 631.43917, 633.32023,
             635.38485, 637.39237, 639.40787, 645.45482, 646.35187, 647.43649, 651.1451,
             657.3668, 657.47836, 659.3835, 661.45214, 667.1764, 669.41844, 672.4039,
             672.4039, 673.34073, 675.46539, 679.41107, 679.4603, 679.51166, 683.43409,
             684.20295, 689.48104, 691.46271, 695.43424, 701.39301, 704.3825, 705.47836,
             713.44465, 715.52022, 717.36695, 719.4916, 723.43728, 725.1639, 727.4603,
             732.46544, 733.50725, 735.48892, 737.50217, 741.1952, 742.44979, 743.44101,
             745.41923, 749.50457, 753.4761, 757.47087, 758.22175, 758.41553, 761.39316,
             763.51782, 767.4635, 771.48652, 773.56209, 777.53347, 779.51514, 789.44544,
             793.53079, 795.54403, 798.58785, 801.49708, 802.43051, 803.54324, 804.40978,
             805.41626, 805.41938, 807.39954, 807.54403, 809.44035, 809.48691, 811.48971,
             811.51797, 815.51273, 819.51718, 821.55968, 823.54135, 824.49887, 827.42978,
             827.46214, 831.60395, 832.4887, 833.47166, 837.557, 839.09742, 842.50943,
             845.10543, 845.5233, 848.49886, 849.44559, 851.57025, 853.51313, 853.5859,
             855.07136, 855.51593, 859.53895, 861.07937, 863.47338, 865.4778, 865.54951,
             865.5859, 867.08737, 867.56757, 869.55983, 870.54073, 871.0453, 871.49959,
             874.49926, 877.49787, 881.47271, 881.58322, 883.51485, 889.54951, 889.64582,
             891.56516, 893.47181, 893.58081, 895.59646, 897.53934, 899.53089, 899.54214,
             903.56516, 905.67979, 906.50434, 906.50434, 909.57573, 909.61211, 911.59378,
             911.62776, 917.4992, 921.52409, 925.60943, 927.6017, 931.51485, 933.57573,
             935.59138, 937.49802, 937.60703, 939.62268, 941.56556, 947.59138, 947.68768,
             950.47305, 953.60194, 953.63833, 955.62, 969.63565, 969.66963, 973.53129,
             977.60194, 979.50949, 979.61759, 981.63324, 983.64889, 985.59177, 985.64356,
             991.61759, 994.15551, 995.51966, 997.62816, 997.66454, 999.64621, 1000.56734,
             1002.58299, 1003.55309, 1005.72955, 1013.66186, 1020.50302, 1020.53604,
             1021.62816, 1023.47417, 1023.51055, 1023.64381, 1025.65946, 1027.67511,
             1027.71149, 1029.61799, 1031.5983, 1033.51603, 1035.64381, 1036.08277,
             1036.53229, 1037.5262, 1041.65437, 1041.69076, 1043.67243, 1043.68543,
             1044.11395, 1045.56365, 1046.59528, 1054.09334, 1057.68808, 1060.08789,
             1060.56331, 1063.77141, 1064.57349, 1064.60987, 1065.49934, 1065.65437,
             1066.0959, 1066.60439, 1067.67002, 1069.68567, 1071.60445, 1071.70132,
             1073.6442, 1079.67002, 1080.53201, 1082.59931, 1085.68059, 1085.71697,
             1085.75336, 1087.69864, 1090.53097, 1091.548, 1101.71429, 1101.72729,
             1109.48982, 1109.68059, 1111.56048, 1111.69624, 1113.71189, 1115.72754,
             1117.67042, 1118.5086, 1121.58372, 1121.81328, 1123.69624, 1126.56399,
             1129.62117, 1129.7068, 1129.74319, 1141.51941, 1143.55031, 1143.79522,
             1153.57354, 1155.72245, 1157.59093, 1157.7381, 1159.76916, 1161.69663,
             1165.58478, 1168.58194, 1173.73302, 1175.52238, 1175.63404, 1179.60043,
             1179.85514, 1183.61574, 1190.60855, 1191.5173, 1191.62896, 1193.61608,
             1199.74867, 1200.57177, 1201.76432, 1201.83709, 1203.64019, 1205.72285,
             1208.61574, 1210.59501, 1210.59501, 1217.75923, 1217.81102, 1219.6351,
             1220.59059, 1225.12537, 1229.80022, 1232.54385, 1232.5978, 1235.52873,
             1243.77488, 1245.79053, 1248.53876, 1249.74906, 1251.70959, 1254.6073,
             1261.78545, 1262.59714, 1262.75793, 1265.63721, 1267.7045, 1277.63319,
             1277.70998, 1278.58553, 1278.64369, 1282.66912, 1287.8011, 1289.81675,
             1293.77528, 1296.68477, 1301.65834, 1302.70121, 1302.71512, 1305.71613,
             1305.81166, 1307.67764, 1308.64302, 1308.65426, 1315.68523, 1316.72425,
             1320.58283, 1323.67255, 1329.63933, 1331.82731, 1332.71917, 1333.84296,
             1336.71071, 1337.80149, 1340.66924, 1344.67539, 1349.83788, 1350.68729,
             1357.69579, 1357.71825, 1365.63933, 1366.69612, 1367.67024, 1371.71144,
             1374.69334, 1375.85353, 1377.86918, 1381.64817, 1381.82771, 1383.69031,
             1384.72999, 1390.68087, 1393.73217, 1393.86409, 1399.69262, 1399.70048,
             1418.72742, 1419.74783, 1419.79544, 1419.87974, 1421.89539, 1424.76448,
             1425.85392, 1433.72056, 1434.76996, 1437.89031, 1438.74374, 1439.81176,
             1442.80019, 1443.64204, 1447.7751, 1449.71548, 1453.83731, 1463.90596,
             1465.71039, 1465.92161, 1469.88014, 1475.74888, 1475.78527, 1476.80567,
             1479.79544, 1481.91652, 1490.74203, 1491.7438, 1491.75185, 1493.59953,
             1493.7343, 1495.61518, 1507.73872, 1507.93217, 1509.94782, 1513.90635,
             1521.75436, 1522.73186, 1525.94274, 1549.6772, 1551.95839, 1553.97404,
             1557.93257, 1566.73944, 1567.74274, 1569.96895, 1585.7584, 1595.9846,
             1598.00025, 1599.83368, 1601.95878, 1613.99517, 1623.88532, 1638.76566,
             1640.01082, 1639.93775, 1642.02647, 1645.985, 1657.79287, 1658.02138,
             1665.90443, 1676.77623, 1684.03703, 1686.05268, 1687.97011, 1690.01121,
             1702.0476, 1707.77214, 1708.71325, 1713.80785, 1716.85112, 1725.86287,
             1728.06325, 1730.0789, 1734.03743, 1744.92283, 1746.07381, 1757.8527,
             1765.73471, 1772.08946, 1774.10511, 1774.85026, 1774.897, 1778.06364,
             1790.10003, 1791.72772, 1792.87858, 1797.01165, 1816.11568, 1818.13133,
             1830.84056, 1834.12624, 1837.96542, 1838.91439, 1847.8051, 1851.92693,
             1860.14189, 1862.15754, 1940.93485, 1987.07801, 1993.97666, 1993.98253,
             2003.07293, 2021.98868, 2055.01485, 2082.96483, 2083.00908, 2109.01285,
             2150.07777, 2155.08522, 2163.05642, 2171.02466, 2184.12551, 2185.03837,
             2193.00248, 2193.99436, 2201.01231, 2208.9974, 2209.98927, 2211.10404,
             2225.11969, 2225.15608, 2239.13534, 2240.16966, 2251.01582, 2267.01074,
             2273.15944, 2283.18018, 2283.18018, 2286.12484, 2289.15437, 2295.14139,
             2297.19584, 2305.14928, 2311.13631, 2321.20707, 2329.17425, 2343.18901,
             2353.1969, 2367.26267, 2375.17884, 2383.95186, 2400.27441, 2501.06722,
             2501.25182, 2510.13177, 2514.33847, 2530.33339, 2550.23269, 2552.24834,
             2564.18093, 2564.36786, 2566.27838, 2581.19473, 2612.18093, 2613.34938,
             2614.19658, 2666.29127, 2670.37084, 2705.16112, 2707.41621, 2720.36337,
             2728.23951, 2746.41925, 2748.39467, 2807.31407, 2872.39278, 2902.41052,
             2904.38261, 2914.50576, 2932.51632, 3211.47446, 3223.28159, 3227.46937,
             3312.30814, 3337.73214, 3346.68149, 3353.72706]


def purge_contaminants(df, decimals=3, negatives=conts_neg, positives=conts_pos):
    """
    Delete contaminant peaks from original dataset - peaks are rows and mz, rt, samples are columns
    :param df: df - dataframe to clean
    :param decimals: int - number of decimal digits to which mz will be approximated
    :param negatives: list - list with mz of contaminants in negative mode
    :param positives: list - list with mz of contaminants in positive mode
    :return: df - cleaned from contaminants dataframe
    """
    # Find contaminants in negative mode
    delete_contamination(df, decimals, negatives)
    # Find contaminants in positive mode
    delete_contamination(df, decimals, positives)
    return df

def delete_contamination(df, decimals, conts):
    """
    Delete peaks from df with mz which is provided in conts with specified precision
    :param df: df - dataframe to clean
    :param decimals: int - number of decimal digits to which mz will be approximated
    :param conts: list - list with mz of contaminants
    :return: df - cleaned from contaminants dataframe
    """
    # Find peaks with mz around contaminants mz
    contaminant_peaks = df['mz'].round(decimals).isin(np.round(conts, decimals))
    # Exclude contaminant peaks from df
    df.drop(contaminant_peaks[contaminant_peaks].index, inplace=True)
